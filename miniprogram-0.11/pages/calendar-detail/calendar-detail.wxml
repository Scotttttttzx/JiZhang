<!--calendar-detail.wxml-->
<view class="main-container">
  <!-- é¡¶éƒ¨å¡ç‰‡ -->
  <view class="top-card">
    <view class="top-card-header">
      <view class="date-text">{{date}}</view>
      <view class="sync-info" bindtap="onManualSync">
        <text class="sync-text">åŒæ­¥äº {{lastSyncTime}}</text>
        <text class="sync-icon {{isRefreshing ? 'refreshing' : ''}}">ğŸ”„</text>
      </view>
    </view>
    <view class="divider"></view>
    <view class="balance-row">
      <text class="balance-label">æ”¯å‡º</text>
      <text class="balance-value out">-{{expense}}</text>
      <text class="balance-label">æ”¶å…¥</text>
      <text class="balance-value in">+{{income}}</text>
    </view>
    <view class="summary-row">
      <view class="summary-item">
        <text class="summary-label">ç»“ä½™</text>
        <text class="summary-value {{balance >= 0 ? 'in' : 'out'}}">{{balance >= 0 ? '+' : ''}}{{balance}}</text>
      </view>
      <view class="summary-item">
        <text class="summary-label">è®°å½•æ•°</text>
        <text class="summary-value">{{totalRecords}}</text>
      </view>
    </view>
    <view class="stats-row">
      <view class="stat-item">
        <text class="stat-label">æ”¯å‡ºç¬”æ•°</text>
        <text class="stat-value">{{expenseCount}}</text>
      </view>
      <view class="stat-item">
        <text class="stat-label">æ”¶å…¥ç¬”æ•°</text>
        <text class="stat-value">{{incomeCount}}</text>
      </view>
    </view>
  </view>
  <view class="record-header">
    <text>æ”¶æ”¯æ˜ç»†</text>
    <text class="record-count">({{totalRecords}}æ¡)</text>
    <view class="header-actions">
      <view class="export-btn" bindtap="onExportData">
        <text class="export-icon">ğŸ“Š</text>
        <text class="export-text">å¯¼å‡º</text>
      </view>
      <view class="test-btn" bindtap="createTestData" wx:if="{{totalRecords === 0}}">
        <text class="test-icon">ğŸ§ª</text>
        <text class="test-text">æµ‹è¯•</text>
      </view>
    </view>
  </view>
  <view class="record-list">
    <block wx:if="{{records.length === 0}}">
      <view class="no-record">å½“å¤©æš‚æ— è®°å½•</view>
    </block>
    <block wx:else>
      <view class="record-item" wx:for="{{records}}" wx:key="id">
        <view class="record-left">
          <text class="record-icon">{{item.category.icon}}</text>
          <view class="record-info">
            <text class="record-category">{{item.category.name}}</text>
            <text class="record-remark" wx:if="{{item.remark}}">{{item.remark}}</text>
            <text class="record-time">{{item.time}}</text>
          </view>
        </view>
        <view class="record-right">
          <text class="record-amount {{item.type === 'expense' ? 'out' : 'in'}}">
            {{item.type === 'expense' ? '-' : '+'}}{{item.amount}}
          </text>
          <view class="delete-btn" catchtap="onDeleteRecord" data-record="{{item}}">
            <text class="delete-icon">ğŸ—‘ï¸</text>
          </view>
        </view>
      </view>
    </block>
  </view>
</view> 