<!--today.wxml-->
<view class="main-container">
  <!-- é¡¶éƒ¨å¡ç‰‡ -->
  <view class="top-card">
    <view class="top-card-header">
      <view class="date-text">{{year}}å¹´{{month}}æœˆ{{day}}æ—¥</view>
    </view>
    <view class="divider"></view>
    <view class="summary-row">
      <view class="summary-item">
        <text class="summary-label">ä»Šæ—¥æ”¯å‡º</text>
        <text class="summary-value out">-{{totalExpense}}</text>
      </view>
      <view class="summary-item">
        <text class="summary-label">ä»Šæ—¥æ”¶å…¥</text>
        <text class="summary-value in">{{totalIncome}}</text>
      </view>
    </view>
  </view>

  <!-- ä»Šæ—¥æ˜ç»†åˆ—è¡¨ -->
  <view class="record-header">
    <text>ä»Šæ—¥æ˜ç»†</text>
    <text class="record-count" wx:if="{{todayRecords.length > 0}}">({{todayRecords.length}}æ¡)</text>
    <view class="header-actions" wx:if="{{todayRecords.length === 0}}">
      <view class="test-btn" bindtap="createTestData">
        <text class="test-icon">ğŸ§ª</text>
        <text class="test-text">æµ‹è¯•</text>
      </view>
    </view>
  </view>
  <view class="record-list">
    <block wx:if="{{todayRecords.length === 0}}">
      <view class="no-record">
        <text class="no-record-icon">ğŸ“</text>
        <text class="no-record-text">ä»Šæ—¥æš‚æ— è®°å½•</text>
        <text class="no-record-desc">ç‚¹å‡»é¦–é¡µ"+"æŒ‰é’®æ·»åŠ ä»Šæ—¥æ”¶æ”¯è®°å½•</text>
      </view>
    </block>
    <block wx:else>
      <view class="record-item" wx:for="{{todayRecords}}" wx:key="id" bindtap="onRecordDetail" data-record="{{item}}">
        <view class="record-left">
          <text class="record-icon">{{item.category.icon}}</text>
          <view class="record-info">
            <text class="record-category">{{item.category.name}}</text>
            <text class="record-remark" wx:if="{{item.remark}}">{{item.remark}}</text>
            <text class="record-time">{{item.time}}</text>
          </view>
        </view>
        <view class="record-right">
          <text class="record-amount {{item.type === 'expense' ? 'out' : 'in'}}">
            {{item.type === 'expense' ? '-' : '+'}}{{item.amount}}
          </text>
          <view class="delete-btn" catchtap="onDeleteRecord" data-record="{{item}}">
            <text class="delete-icon">ğŸ—‘ï¸</text>
          </view>
        </view>
      </view>
    </block>
  </view>
</view>

<view class="accounts-section wide-block">
  <view class="accounts-list">
    <block wx:if="{{accounts.length === 0}}">
      <view class="no-accounts">
        <text class="no-accounts-icon">ğŸ¦</text>
        <text class="no-accounts-text">æš‚æ— è´¦æˆ·</text>
        <text class="no-accounts-desc">ç‚¹å‡»ä¸Šæ–¹\"æ·»åŠ è´¦æˆ·\"å¼€å§‹ç®¡ç†æ‚¨çš„èµ„äº§</text>
      </view>
    </block>
    <block wx:else>
      <view class="account-item" wx:for="{{accounts}}" wx:key="id" bindtap="onAccountDetail" data-account="{{item}}">
        <view class="account-left">
          <view class="account-icon" style="background-color: {{item.type ? item.type.color : '#ccc'}}">
            <text>{{item.type ? item.type.icon : ''}}</text>
          </view>
          <view class="account-info">
            <text class="account-name">{{item.name}}</text>
            <text class="account-type">{{item.type ? item.type.name : ''}}</text>
            <text class="account-remark" wx:if="{{item.remark}}">{{item.remark}}</text>
          </view>
        </view>
        <view class="account-right">
          <text class="account-balance">Â¥{{item.balance ? item.balance.toFixed(2) : '0.00'}}</text>
          <view class="account-actions">
            <view class="action-btn edit-btn" catchtap="onEditAccount" data-account="{{item}}"><text>ç¼–è¾‘</text></view>
            <view class="action-btn delete-btn" catchtap="onDeleteAccount" data-account="{{item}}"><text>åˆ é™¤</text></view>
          </view>
        </view>
      </view>
    </block>
  </view>
</view>

<view class="suggestion-item" wx:for="{{suggestions}}" wx:key="index">
  <text class="suggestion-title">{{item.title ? item.title : ''}}</text>
  <text class="suggestion-content">{{item.content ? item.content : ''}}</text>
</view>

<view class="chat-bubble {{msg.role}}">
  <text>{{msg.content ? msg.content : ''}}</text>
</view> 